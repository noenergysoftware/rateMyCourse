<!DOCTYPE html>

<html lang="zh-cn" class=" no-touchevents"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

	<meta content="IE=edge" http-equiv="X-UA-Compatible">
	<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no, width=device-width" name="viewport">
	<meta name="theme-color" content="#4285f4">
	<title>注册</title>
	<link rel="shortcut icon" href="./resource/favicon.ico" />
  <link rel="bookmark" href="./resource/favicon.ico" />
	<!-- css -->
	<link href="./css/base.min.css" rel="stylesheet">
	<link href="./css/project.min.css" rel="stylesheet">
	<link href="./css/auth.css" rel="stylesheet">
  <link href="./css/css.css" rel="stylesheet">

<style>
.divcss5{ position:fixed; bottom:0;}
</style>
<body class="page-brand">
	

	<div class="authpage auth-reg">
			<div class="container">
				<section class="content-inner">
					<div class="auth-main auth-row">
						<div class="auth-top auth-row">
							<a class="boardtop-left" href="https://ratemycourse.tk/index.html">
								<div>首 页</div>
							</a>
							<div class="auth-logo">
								<img src="./resource/authlogo.jpg" alt="">
							</div>
							<a href="https://ratemycourse.tk/login.html" class="boardtop-right">
								<div>登 录</div>
							</a>
						</div>

					

						<div class="rowtocol">
							<div class="auth-row">
								<div class="form-group-label auth-row">
									<label class="floating-label" for="name">用户名，字母、数字或下划线，3-16位</label>
									<input class="form-control maxwidth-auth" id="name" name="inputUsername" type="text" maxlength="16" >
									
								</div>
								<div id="namecheck"></div>
							</div>
						</div>
						
						<div class="rowtocol">
							<div class="auth-row">
								<div class="form-group-label auth-row">
									<label class="floating-label" for="email">邮箱(唯一凭证请认真对待)</label>
									<input class="form-control maxwidth-auth" id="email" name="inputEmail" type="email" maxlength="32">
									

								</div>
								<div id="emailcheck"></div>
							</div>
						</div>

						<div class="rowtocol">
							<div class="auth-row">
								<div class="form-group-label auth-row">
									<label class="floating-label" for="passwd">密码，必须含字母、数字和特称字符，8-30位</label>
									<input class="form-control maxwidth-auth" id="passwd" name="inputPassword" type="password">
								</div>
							</div>
						</div>

						<div class="rowtocol">
							<div class="auth-row">
								<div class="form-group form-group-label">
									<label class="floating-label" for="repasswd">重复密码</label>
									<input class="form-control maxwidth-auth" id="repasswd" name="inputVerify" type="password">
								</div>
							</div>
						</div>
								

						<div class="rowtocol">
							<div class="btn-auth auth-row">
								<button id="TencentCaptcha" data-appid="2091355657" data-cbfn="callback" class="btn-reg btn btn-block btn-brand waves-attach waves-light waves-effect">人机验证</button>
							</div>
						</div>
						
						<div class="rowtocol">
							<div class="btn-auth auth-row">
								<button id="tos" type="submit" class="btn-reg btn btn-block btn-brand waves-attach waves-light waves-effect">确认注册</button>
							</div>
						</div>
						
						<div class="auth-bottom auth-row auth-reg" >
							<div class="tgauth">
								<button class="btn" style="cursor:unset;"></button>
							</div>
						</div>

					

					</div>
				</section>

				<div class="card auth-tg">
					<div class="card-main">
					</div>
				</div>

			</div>

	</div>
		

<footer class="ui-footer">
	<div class="container">
		<marquee>©2019 公课网开发团队</marquee>
	</div>
</footer>

<!-- js -->
	<script src="./js/jquery.js"></script>
  <script src="./js/gt.js"></script>
  <script src="./js/base.min.js"></script>
	<script src="./js/project.min.js"></script>
	<script src="./js/jquery.validate.js"></script>
	<script color="255,0,255" opacity="0.7" count="88" src="./js/canvas-nest.js"></script>
	<script src="./js/md5.min.js"></script>
	<script src="https://ssl.captcha.qq.com/TCaptcha.js"></script>
	<script src="https://pv.sohu.com/cityjson?ie=utf-8"></script>
	<canvas id="c_n5" width="1500" height="600" style="position: fixed; top: 0px; left: 0px; z-index: -1; opacity: 0.5;"></canvas>

<script>
    $(document).ready(function(){
				var Captcha=false;
				var Res;
				window.callback = function(res){
						//console.log(res)
						// res（用户主动关闭验证码）= {ret: 2, ticket: null}
						// res（验证成功） = {ret: 0, ticket: "String", randstr: "String"}
						if(res.ret === 0){
								//alert(res.ticket)   // 票据
								Captcha=true;
								$("#TencentCaptcha").text("人机验证通过");
								$("#TencentCaptcha").attr("disabled","disabled"); 
								Res=res;
						}
				}
				var IP=returnCitySN["cip"];
				console.log(IP);
				

				function register(){
						console.log(Res.ticket);
						console.log(Res.randstr);
						$.ajax({
								async: false,
								type:"POST",
								url: "https://api.ratemycourse.tk/signUp/",
								dataType:"json",
								data:{              
										username: $("#name").val(),
										mail: $("#email").val(),
										password: md5($("#passwd").val()),
										IP:IP,
										Ticket: Res.ticket,
										Randstr: Res.randstr
								},
								xhrFields: {
										withCredentials: true
								},
								success:function(data){
										//data=JSON.parse(data);
									//	alert("ajax success");
										console.log(data);
										console.log(data.status)
										if(data.status=="1"){
												alert(data.body.message);
												window.setTimeout("location.href='./login.html'", 1000);
										}
										else{
											alert(data.errMsg);
										}
										
								},
								error:function(data){
									alert(JSON.stringify(data));
								}
						});
				}
				$("#tos").click(function(){
						if(check(Captcha)==true){
							register();
						}
        });
				
				$("html").keydown(function (event) {
            //13 = enter
            if (event.keyCode == 13) {
								if(check(Captcha)==true){
										register();
								}
            }
        });

    });
	
</script>
<script>
	function check(check_Captcha){
		var errmsg="";

		var name=$("#name").val();
		console.log(name);
		var uPattern = /^[a-zA-Z0-9_]{3,16}$/;
		var check_name=uPattern.test(name);
		console.log(check_name);

		if(check_name==false){
				errmsg=errmsg+"用户名格式错误\n";
		}

		var email=$("#email").val();
		console.log(email);
		var ePattern = /^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/;
		var check_email=ePattern.test(email)
		console.log(check_email);

		if(check_email==false){
				errmsg=errmsg+"邮箱格式错误\n";
		}
		
		var password=$("#passwd").val();
		var repassword=$("#repasswd").val();
		console.log(password);
		console.log(repassword);
		var pdPattern = /^(?=.*[0-9])(?=.*[a-zA-Z])(?=.*[^a-zA-Z0-9]).{8,30}$/;
		var check_password=pdPattern.test(password);
		console.log(check_password);

		if(check_password==false){
			errmsg=errmsg+"密码格式错误\n";
		}
		
		if(password!=repassword){
			errmsg=errmsg+"两次密码不一致\n";
			check_password=false;
		}

		if(check_Captcha==false){
			errmsg=errmsg+"人机验证未通过\n";
		}

		if( check_name==false || check_email==false || check_password==false || check_Captcha==false){
			alert(errmsg);
			return false;
		}
		return true;
	}
</script>




		

    

<canvas id="NooBox-VideoBeyond-preCanvas" style="display: none"></canvas>
<div id="NooBox-Video-Indicator"></div>


</body>
</html>